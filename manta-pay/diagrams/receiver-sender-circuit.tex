\documentclass{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[a4paper, landscape, margin=0.8in]{geometry}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{tikz-cd}

\tikzcdset{row sep/normal = 2em}

% Drawn with the help of <https://tikzcd.yichuanshen.de>.

\begin{document}

\pagenumbering{gobble}

\begin{center}
    \Large{\textbf{Receiver and Sender Circuits}} \\
    \small{\textbf{NB}: \textit{Does not include UTXO accumulator proof.}}
\end{center}

\vspace{1.5em}

\begin{center}
\begin{tikzcd}
                         &                                           &                                                                                                                    & {} \arrow[dddd, no head, dotted] &                                                          &                                        &                                                         \\
                         & \textsf{id} : \mathbb{F} \arrow[d]        & |[red, draw=black]| \textsf{asset} : \textsf{Asset} \arrow[l, dashed] \arrow[d, dashed] \arrow[rr]                                                     &                                  & {\textsf{note} : (\mathbb{S}, \textsf{Asset})} \arrow[r] & \textbf{AES} \arrow[r, Rightarrow]     & |[blue, draw=black]| \textsf{C}_\textsf{note} : \textsf{List}(\textsf{Bool}) \\
|[blue, draw=black]| \textsf{cm} : \mathbb{F} & \mathbf{Poseidon}_4 \arrow[l, Rightarrow] & \textsf{value} : \mathbb{F} \arrow[l]                                                                              &                                  & |[blue, draw=black]| \textsf{epk} : \mathbb{G}                                & \textbf{Blake2s} \arrow[u, Rightarrow] &                                                         \\
                         & \textsf{rk.spend} : \mathbb{G} \arrow[u]  & |[red, draw=black]| \textsf{esk} : \mathbb{S} \arrow[lu] \arrow[rrr] \arrow[rru, "\textbf{DHKE}" description, Rightarrow] \arrow[rruu] &                                  &                                                          & \textbf{DHKE} \arrow[u, Rightarrow]    & |[red, draw=black]| \textsf{rk.view} : \mathbb{G} \arrow[l]                 \\
                         &                                           &                                                                                                                    & {}                               &                                                          &                                        &                                                        
\end{tikzcd}
\end{center}

\begin{center}
\begin{tikzcd}
            &                                           &                                                      &                                                                                              & {} \arrow[ddddd, no head, dotted] &                                                                        &                                                                   \\
            &                                           & \textsf{asset} : \textsf{Asset} \arrow[ld, dashed] \arrow[d, dashed] &                                                                                              &                                   & {\textsf{note} : (\mathbb{S}, \textsf{Asset})} \arrow[lld, dashed] \arrow[lll, dashed] &                                                                   \\
            & \textsf{id} : \mathbb{F} \arrow[rd]       & \textsf{value} : \mathbb{F} \arrow[d]                & \textsf{esk} : \mathbb{S} \arrow[ld]                                                         &                                   & \textbf{AES} \arrow[u, Rightarrow]                                     & |[red, draw=black]| \textsf{C}_\textsf{note} : \textsf{List}(\textsf{Bool}) \arrow[l] \\
            & \textsf{cm} : \mathbb{F} \arrow[d]        & \mathbf{Poseidon}_4 \arrow[l, Rightarrow]            & \textsf{rk.spend} : \mathbb{G} \arrow[l]                                                     &                                   & \textbf{Blake2s} \arrow[u, Rightarrow]                                 & |[red, draw=black]| \textsf{epk} : \mathbb{G} \arrow[ld]                              \\
    |[blue, draw=black]| \textsf{vn} : \mathbb{F} & \textbf{Poseidon}_2 \arrow[l, Rightarrow] &                                                      & |[red, draw=black]| \textsf{sk.spend} : \mathbb{S} \arrow[u, "\textbf{DHKE}" description, Rightarrow] \arrow[ll] &                                   & \textbf{DHKE} \arrow[u, Rightarrow]                                    & |[red, draw=black]| \textsf{sk.view} : \mathbb{G} \arrow[l]                           \\
            &                                           &                                                      &                                                                                              & {}                                &                                                                        &                                                                  
\end{tikzcd}
\end{center}

\vspace{1em}

\begin{center}
    \emph{The circuits are on the left of the dotted lines.}
\end{center}

\vspace{3em}

\[
    (\rightarrow) := \text{input}
    \,\,\,\,\,\,\,
    (\Rightarrow) := \text{computation}
    \,\,\,\,\,\,\,
    (\dasharrow) := \text{projection}
    \,\,\,\,\,\,\,
    (\,\cdots\,) := \text{circuit boundary}
    \,\,\,\,\,\,\,
    ({\color{red}{x : T}}) := \text{private input}
    \,\,\,\,\,\,\,
    ({\color{blue}{x : T}}) := \text{public output}
\]

\end{document}
