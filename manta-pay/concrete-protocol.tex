\lsection{Concrete Protocol}{concrete-protocol}

We define the instantiation of the abstract protocol in this section.

\subsection{Preliminaries}

\subsubsection{Elliptic Curve Cryptography}

Since we use a Zero-Knowledge Proving System, we want the cryptographic constructions below to be \emph{ZKP-friendly}. To denote the elliptic-curve constructions that live inside of a ZKP system we use the term ``embedded'' and denote the embedded elliptic curve group $\mathbb{G}$ with scalar field $\mathbb{F}$ for the following sections. See \autoref{def:concrete-zkp} for more.

\subsubsection{Poseidon Permutation}

One of the major building blocks of our cryptographic primitives is the \Poseidon{} Permutation \cite{KRRS21USENIX}.

\subsection{Concrete Cryptographic Schemes}

\begin{definitiontoc}{Commitment Schemes}
    Poseidon hash \cite{KRRS21USENIX} for \UTXO{} commitment (arity-4) or Pedersen Commitment variant and Poseidon hash for \VN{} hash (arity-2)
\end{definitiontoc}

\begin{definitiontoc}{Key-Agreement Scheme}
    For $\KA$, we use a Diffie-Hellman Key Exchange over $(\mathbb{G}, \mathbb{F})$:
    \begin{align*}
        \KA.\derive(x)   &: \mathbb{F} \to \mathbb{G}                   := x \cdot G \\
        \KA.\agree(x, y) &: \mathbb{F} \times \mathbb{G} \to \mathbb{G} := x \cdot y
    \end{align*}
    where $G$ is a fixed public point.
\end{definitiontoc}

\begin{definitiontoc}{Symmetric-Key Encryption Scheme}
    For $\SYM$, we use symmetric-key encryption scheme: AES-GCM~\cite{rfc5288} with magic-number nonce and no associated data. Note that it is safe to reuse the nonce here because we assume that the encryption key is only used once.
\end{definitiontoc}

\begin{definitiontoc}{Key-Derivation Functions}
    For $\KDF$, we use Blake2s~\cite{rfc7693} with magic-number salt.
\end{definitiontoc}

\begin{definitiontoc}{Dynamic Cryptographic Accumulator}
    For $\DCA$, we use a Merkle Tree with of arity-2 with \Poseidon{} as the inner node combining hash function.

    \TODO{dynamic cryptographic accumulator: Merkle Tree with Poseidon hashes (incremental tree for the ledger is an optimization since it only needs to know enough to compute the accumulated value)}
\end{definitiontoc}

\begin{definitiontoc}{Non-Interactive Zero-Knowledge Proving System} \label{def:concrete-zkp}
    For $\NIZK$, the protocol can use any non-interactive zero-knowledge proving system like Groth16 \cite{KRRS21USENIX} and/or PLONK/PLONKUP~\cite{plonk,plonkup}. 
\end{definitiontoc}

